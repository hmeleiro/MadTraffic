domain = shp$nivelServicio, pretty = T, bins = 6
)
shp$popup <- paste(
"Nombre:", shp$nombre, "<br>",
"Carga:", shp$carga, "<br>",
"Nivel servicio:", shp$nivelServicio
)
shp %>%
leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup, color = ~pal2(nivelServicio), weight = 2, opacity = 1)
pal2 <- colorBin(
palette = 'Reds',
domain = shp$nivelServicio, pretty = T
)
shp$popup <- paste(
"Nombre:", shp$nombre, "<br>",
"Carga:", shp$carga, "<br>",
"Nivel servicio:", shp$nivelServicio
)
shp %>%
leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup, color = ~pal2(nivelServicio), weight = 2, opacity = 1)
pal2 <- colorBin(
palette = 'Reds',
domain = shp$nivelServicio
)
shp$popup <- paste(
"Nombre:", shp$nombre, "<br>",
"Carga:", shp$carga, "<br>",
"Nivel servicio:", shp$nivelServicio
)
shp %>%
leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup, color = ~pal2(nivelServicio), weight = 2, opacity = 1)
pal2 <- colorFactor(
palette = 'Reds',
domain = shp$nivelServicio
)
shp$popup <- paste(
"Nombre:", shp$nombre, "<br>",
"Carga:", shp$carga, "<br>",
"Nivel servicio:", shp$nivelServicio
)
shp %>%
leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup, color = ~pal2(nivelServicio), weight = 2, opacity = 1)
shp %>%
leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup, color = ~pal2(nivelServicio), weight = 2, opacity = 0.7)
shp %>%
leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup, color = ~pal2(nivelServicio), weight = 2, opacity = 0.2)
shp %>%
leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup, color = ~pal2(nivelServicio), weight = 2, opacity = 0.3)
shp %>%
leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup, color = ~pal2(nivelServicio), weight = 2, opacity = 0.5)
url <- "https://informo.madrid.es/informo/tmadrid/pm.xml"
dataRealTime <- readRealTime(url) %>% mutate(id = as.numeric(idelem))
shp <- read_sf("data/pmed_ubicacion_06-2022/pmed_ubicacion_06-2022.shp")
shp <- st_transform(shp, crs = "+proj=longlat +datum=WGS84")
# shp <- st_point_on_surface(shp)
shp <- merge(shp, dataRealTime, by = "id")
# If you want to use predefined palettes in the RColorBrewer package:
# Call RColorBrewer::display.brewer.all() to see all possible palettes
pal <- colorNumeric(
palette = 'Dark2',
domain = shp$carga
)
pal2 <- colorFactor(
palette = 'Reds',
domain = shp$nivelServicio
)
shp$popup <- paste(
"Nombre:", shp$nombre, "<br>",
"Carga:", shp$carga, "<br>",
"Nivel servicio:", shp$nivelServicio
)
shp %>%
leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup, color = ~pal2(nivelServicio), weight = 2, opacity = 0.5)
shp %>%
leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup, color = ~pal2(nivelServicio),smoothFactor = 3, weight = 30 , opacity = 0.5)
shp %>%
leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup, color = ~pal2(nivelServicio),smoothFactor = 3, weight = 3 , opacity = 0.5)
shp %>%
leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup, color = ~pal2(nivelServicio),smoothFactor = 3, weight = 3, opacity = 0.8)
shp %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup, color = ~pal2(nivelServicio),smoothFactor = 3, weight = 3, opacity = 0.8)
shp %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup, color = ~pal2(nivelServicio),smoothFactor = 3, weight = 3, stroke = F, opacity = 0.8)
shp %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup, color = ~pal2(nivelServicio),smoothFactor = 3, weight = 3, stroke = F, fill = T, opacity = 0.8)
shp %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup,
fillColor = ~pal2(nivelServicio),
smoothFactor = 3, weight = 3, stroke = F,opacity = 0.8)
shp %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup,
fillColor = ~pal2(nivelServicio),fill = T,
smoothFactor = 3, weight = 3, stroke = F, opacity = 0.8)
shp %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup,
fillColor = ~pal2(nivelServicio),fill = T,fillOpacity = 1,
smoothFactor = 3, weight = 3, stroke = F, opacity = 0.8)
shp %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup,
fillColor = ~pal2(nivelServicio),
fill = T, fillOpacity = 1
smoothFactor = 3, weight = 3, stroke = T, opacity = 0.8)
shp %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup,
fillColor = ~pal2(nivelServicio),
fill = T, fillOpacity = 1,
smoothFactor = 3, weight = 3, stroke = T, opacity = 0.8)
shp %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = F,
stroke = T,
fillOpacity = 1,
smoothFactor = 3, weight = 3, opacity = 0.8)
shp %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = F,
fillOpacity = 1,
smoothFactor = 3, weight = 3, opacity = 0.8)
shp %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = F,
fillOpacity = 1,
smoothFactor = 1, weight = 3, opacity = 0.8)
shp %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
fillOpacity = 1,
smoothFactor = 1, weight = 3, opacity = 0.8)
url <- "https://informo.madrid.es/informo/tmadrid/pm.xml"
dataRealTime <- readRealTime(url)
df_sf <- st_as_sf(dataRealTime, coords = c("st_x", "st_y"), crs = "+proj=utm +zone=30")
#Projection transformation
sfc = st_transform(df_sf, crs = "+proj=longlat +datum=WGS84")
# shp %>%
sfc %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
fillOpacity = 1,
smoothFactor = 1, weight = 3, opacity = 0.8)
url <- "https://informo.madrid.es/informo/tmadrid/pm.xml"
dataRealTime <- readRealTime(url)
df_sf <- st_as_sf(dataRealTime, coords = c("st_x", "st_y"), crs = "+proj=utm +zone=30")
#Projection transformation
sfc = st_transform(df_sf, crs = "+proj=longlat +datum=WGS84")
sfc
# shp %>%
sfc %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
fillOpacity = 1,
smoothFactor = 1, weight = 3, opacity = 0.8)
sfc %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
fillOpacity = 1,
smoothFactor = 1, weight = 3, opacity = 0.8)
sfc %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
fillOpacity = 1, weight = 3, opacity = 0.8)
df_sf <- st_as_sf(dataRealTime, coords = c("st_x", "st_y"), crs = "+proj=utm +zone=30")
#Projection transformation
sfc = st_transform(df_sf, crs = "+proj=longlat +datum=WGS84")
pal <- colorNumeric(
palette = 'Dark2',
domain = sfc$carga
)
pal2 <- colorFactor(
palette = 'Reds',
domain = sfc$nivelServicio
)
sfc %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
fillOpacity = 1, weight = 3, opacity = 0.8)
url <- "https://informo.madrid.es/informo/tmadrid/pm.xml"
dataRealTime <- readRealTime(url)
df_sf <- st_as_sf(dataRealTime, coords = c("st_x", "st_y"), crs = "+proj=utm +zone=30")
#Projection transformation
sfc = st_transform(df_sf, crs = "+proj=longlat +datum=WGS84")
pal <- colorNumeric(
palette = 'Dark2',
domain = sfc$carga
)
pal2 <- colorFactor(
palette = 'Reds',
domain = sfc$nivelServicio
)
sfc$popup <- paste(
"Nombre:", shp$nombre, "<br>",
"Carga:", shp$carga, "<br>",
"Nivel servicio:", shp$nivelServicio
)
sfc %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
fillOpacity = 1, weight = 3, opacity = 0.8)
tiles_url <- "https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}"
sfc %>%
leaflet() %>%
addTiles(urlTemplate = tiles_url) %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
fillOpacity = 1, weight = 3, opacity = 0.8)
sfc %>%
leaflet() %>%
addTiles(urlTemplate = tiles_url) %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
weight = 3,
fillOpacity = 1,
opacity = 0.7)
sfc %>%
leaflet() %>%
addTiles(urlTemplate = tiles_url) %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
weight = 3,
fillOpacity = 0.7,
opacity = 0.7)
# tiles_url <- "https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}"
# tiles_url <- "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png"
tiles_url <- "https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png"
sfc %>%
leaflet() %>%
addTiles(urlTemplate = tiles_url) %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
weight = 3,
fillOpacity = 0.7,
opacity = 0.7)
sfc %>%
leaflet() %>%
addTiles(urlTemplate = tiles_url) %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
weight = 1.5,
fillOpacity = 0.7,
opacity = 0.7)
shp$nivelServicio
pal2 <- colorFactor(
palette = c('red', 'blue', 'green', 'purple', 'orange'),
domain = shp$nivelServicio
)
shp$popup <- paste(
"Nombre:", shp$nombre, "<br>",
"Carga:", shp$carga, "<br>",
"Nivel servicio:", shp$nivelServicio
)
shp %>%
leaflet() %>%
addTiles(urlTemplate = "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png") %>%  # Add default OpenStreetMap map tiles
addPolygons(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
fillOpacity = 1,
smoothFactor = 1, weight = 3, opacity = 0.8)
url <- "https://informo.madrid.es/informo/tmadrid/pm.xml"
dataRealTime <- readRealTime(url)
df_sf <- st_as_sf(dataRealTime, coords = c("st_x", "st_y"), crs = "+proj=utm +zone=30")
#Projection transformation
sfc = st_transform(df_sf, crs = "+proj=longlat +datum=WGS84")
pal <- colorNumeric(
palette = 'Dark2',
domain = sfc$carga
)
pal2 <- colorFactor(
palette = c('red', 'blue', 'green', 'purple', 'orange'),
domain = shp$nivelServicio
)
sfc$popup <- paste(
"Nombre:", shp$nombre, "<br>",
"Carga:", shp$carga, "<br>",
"Nivel servicio:", shp$nivelServicio
)
# tiles_url <- "https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}"
# tiles_url <- "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png"
tiles_url <- "https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png"
sfc %>%
leaflet() %>%
addTiles(urlTemplate = tiles_url) %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
weight = 1.5,
fillOpacity = 0.7,
opacity = 0.7)
df_sf <- st_as_sf(dataRealTime, coords = c("st_x", "st_y"), crs = "+proj=utm +zone=30")
#Projection transformation
sfc = st_transform(df_sf, crs = "+proj=longlat +datum=WGS84")
pal <- colorNumeric(
palette = 'Dark2',
domain = sfc$carga
)
pal2 <- colorFactor(
palette = c('red', 'blue', 'green', 'purple', 'orange'),
domain = sfc$nivelServicio
)
sfc$popup <- paste(
"Nombre:", sfc$nombre, "<br>",
"Carga:", sfc$carga, "<br>",
"Nivel servicio:", sfc$nivelServicio
)
# tiles_url <- "https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}"
# tiles_url <- "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png"
tiles_url <- "https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png"
sfc %>%
leaflet() %>%
addTiles(urlTemplate = tiles_url) %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
weight = 1.5,
fillOpacity = 0.7,
opacity = 0.7)
pal2 <- colorFactor(
palette = "reds",
domain = sfc$nivelServicio
)
sfc$popup <- paste(
"Nombre:", sfc$nombre, "<br>",
"Carga:", sfc$carga, "<br>",
"Nivel servicio:", sfc$nivelServicio
)
# tiles_url <- "https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}"
# tiles_url <- "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png"
tiles_url <- "https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png"
sfc %>%
leaflet() %>%
addTiles(urlTemplate = tiles_url) %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
weight = 1.5,
fillOpacity = 0.7,
opacity = 0.7)
pal2 <- colorFactor(
palette = "reds",
domain = sfc$nivelServicio, reverse = T
)
# tiles_url <- "https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}"
# tiles_url <- "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png"
tiles_url <- "https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png"
sfc %>%
leaflet() %>%
addTiles(urlTemplate = tiles_url) %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
weight = 1.5,
fillOpacity = 0.7,
opacity = 0.7)
pal2 <- colorFactor(
palette = "reds",
domain = sfc$nivelServicio, reverse = F
)
sfc$popup <- paste(
"Nombre:", sfc$nombre, "<br>",
"Carga:", sfc$carga, "<br>",
"Nivel servicio:", sfc$nivelServicio
)
# tiles_url <- "https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}"
# tiles_url <- "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png"
tiles_url <- "https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png"
sfc %>%
leaflet() %>%
addTiles(urlTemplate = tiles_url) %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
weight = 1.5,
fillOpacity = 0.7,
opacity = 0.7)
pal2 <- colorFactor(
palette = "Reds",
domain = sfc$nivelServicio, reverse = F
)
sfc$popup <- paste(
"Nombre:", sfc$nombre, "<br>",
"Carga:", sfc$carga, "<br>",
"Nivel servicio:", sfc$nivelServicio
)
# tiles_url <- "https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}"
# tiles_url <- "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png"
tiles_url <- "https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png"
sfc %>%
leaflet() %>%
addTiles(urlTemplate = tiles_url) %>%  # Add default OpenStreetMap map tiles
addCircles(popup = ~popup,
fillColor = ~pal2(nivelServicio),
color = ~pal2(nivelServicio),
fill = T,
stroke = T,
weight = 1.5,
fillOpacity = 0.7,
opacity = 0.7)
